<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>GC Game Closure Docs: utilities</title>
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="shortcut icon" href="/include/fav.png">
    <link rel="stylesheet" href="/include/bootstrap.min.css">
    <link rel="stylesheet" href="/include/prettify.css">
    <link rel="stylesheet" href="/include/style.css">
    <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Open+Sans:300,400,700">
    <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Puritan:400,700">
    <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Droid+Sans:400,700">
    <meta name="description" content="Documentation for the Game Closure DevKit.">
  </head>
  <body>
    <div class="navbar navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-fluid">
          
          <ul class="nav pull-left">
            <li>
              <a href="../index.html" id="header-logo-text">
                <img src="/include/img/logo-text-small.png"> Game Closure Docs
              </a>
            </li>
          </ul>

          <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>

          <div class="nav-collapse collapse">
            <ul class="nav pull-right">
              <li><a href="../index.html#quickstart">Quick Start</a></li>
              <li><a href="../index.html#guides">Guides</a></li>
              <li><a href="../index.html#examples">Examples</a></li>
              <li><a href="../native.html">Native</a></li>
              <li><a href="../guide/contributors.html">Contributors</a></li>
              <li><a href="../support.html">Support</a></li>
            </ul>
          </div>
          
        </div>
      </div>

      <div class="nav-collapse collapse sub-nav">
            <ul class="nav pull-right">
              <li><a href="../api/appengine.html">Game Engine</a></li>
              <li class="dropdown">
                <a class="dropdown-toggle" data-toggle="dropdown" href="#">UI Components<b class="caret"></b></a>
                <ul class="dropdown-menu" role="menu">
                  <li>
                    <a href="../api/ui-view.html">ui.View</a>
                    <ul>
                      <li><a href="../api/ui-view.html#style-object">↪ Styles</a></li>
                      <li><a href="../api/ui-view.html#events">↪ Events</a></li>
                      <li><a href="../api/ui-view.html#input-events">↪ Input Events</a></li>
                    </ul>
                  </li>
                  <li><a href="../api/ui-text.html">Text</a></li>
                  <li><a href="../api/ui-text.html#class-ui.textview">ui.TextView</a></li>
                  <li>
                    <a href="../api/ui-text.html#class-ui.textpromptview">ui.TextPromptView</a>
                    <ul>
                      <li><a href="../api/ui-text.html#events">↪ Events</a></li>
                    </ul>
                  </li>
                  <li>
                    <a href="../api/ui-text.html#class-ui.texteditview">ui.TextEditView</a>
                    <ul>
                      <li><a href="../api/ui-text.html#events-1">↪ Events</a></li>
                    </ul>
                  </li>
                  <li><a href="../api/ui-text.html#class-ui.scoreview">ui.ScoreView</a></li>
                  <!--<li><a href="../api/ui-text.html#class-ui.textinputview">ui.TextInputView</a></li>-->
                  <li><a href="../api/ui-text.html#class-ui.resource.font">ui.resource.Font</a></li>
                  <li><a href="../api/ui-images.html">Images</a></li>
                  <li><a href="../api/ui-images.html#class-ui.imageview">ui.ImageView</a></li>
                  <li><a href="../api/ui-images.html#class-ui.imagescaleview">ui.ImageScaleView</a></li>
                  <li><a href="../api/ui-images.html#class-ui.resource.image">ui.resource.Image</a></li>
                  <li>
                    <a href="../api/ui-spriteview.html">ui.SpriteView</a>
                    <ul>
                      <li><a href="../api/ui-spriteview.html#class-sprite-groups">↪ Sprite Groups</a></li>
                    </ul>
                  </li>
                  <li><a href="../api/ui-gestureview.html">ui.GestureView</a></li>
                  <li class="divider"></li>
                  <li><a href="../api/ui-color.html">ui.Color</a></li>
                  <li><a href="../api/ui-filter.html">Filters</a></li>
                  <li><a href="../api/ui-filter.html#class-ui.filter.filter">ui.filter.Filter</a></li>
                  <li><a href="../api/ui-filter.html#class-ui.filter.linearaddfilter">ui.filter.LinearAddFilter</a></li>
                  <li><a href="../api/ui-filter.html#class-ui.filter.multiplyfilter">ui.filter.MultiplyFilter</a></li>
                </ul>
              </li>
              <li class="dropdown">
                <a class="dropdown-toggle" data-toggle="dropdown" href="#">UI Widgets<b class="caret"></b></a>
                <ul class="dropdown-menu" role="menu">
                  <li>
                    <a href="../api/ui-stackview.html">ui.StackView</a>
                    <ul>
                      <li><a href="../api/ui-stackview.html#events">↪ Events</a></li>
                    </ul>
                  </li>
                  <li>
                    <a href="../api/ui-scrollview.html">ui.ScrollView</a>
                    <ul>
                      <li><a href="../api/ui-scrollview.html#events">↪ Events</a></li>
                    </ul>
                  </li>
                  <li>
                    <a href="../api/ui-viewpool.html">ui.ViewPool</a>
                  </li>
                  <li class="divider"></li>
                  <li>
                    <a href="../api/ui-widget-listview.html">ui.widget.ListView</a>
                    <ul>
                      <li><a href="../api/ui-widget-listview.html#class-ui.widget.cellview">↪ ui.widget.CellView</a></li>
                      <li><a href="../api/ui-widget-listview.html#class-gcdatasource">↪ GCDataSource</a></li>
                    </ul>
                  </li>
                  <li><a href="../api/ui-widget-gridview.html">ui.widget.GridView</a></li>
                  <li>
                    <a href="../api/ui-widget-buttonview.html">ui.widget.ButtonView</a>
                    <ul>
                      <li><a href="../api/ui-widget-buttonview.html#events">↪ Events</a></li>
                    </ul>
                  </li>
                  <li>
                    <a href="../api/ui-widget-sliderview.html">ui.widget.SliderView</a>
                    <ul>
                      <li><a href="../api/ui-widget-sliderview.html#events">↪ Events</a></li>
                    </ul>
                  </li>
                  <!--<li><a href="../api/ui-widget-spinner.html">ui.widget.Spinner</a></li>-->
                  <li><a href="../api/ui-widget-toast.html">ui.widget.Toast</a></li>
                </ul>
              </li>
              <li class="dropdown">
                <a class="dropdown-toggle" data-toggle="dropdown" href="#">Events<b class="caret"></b></a>
                <ul class="dropdown-menu" role="menu">
                  <li><a href="../api/event.html">Events</a></li>
                  <li><a href="../api/event.html#class-event.emitter">event.Emitter</a></li>
                  <li><a href="../api/event.html#class-event.callback">event.Callback</a></li>
                  <li><a href="../api/event.html#class-event.input.inputevent">event.input.InputEvent</a></li>
                  <li><a href="../api/event.html#drag-events-event.input.drag">Drag Events</a></li>
                  <li><a href="../api/event.html#rotation-events">Rotation Events</a></li>
                  <li><a href="../api/event.html#back-button">Back Button</a></li>
                </ul>
              </li>
              <li><a href="../api/device.html">Device</a></li>
              <li><a href="../api/animate.html">Animation</a></li>
              <li><a href="../api/audio.html">Audio</a></li>
              <li class="dropdown">
                <a class="dropdown-toggle" data-toggle="dropdown" href="#">Utilities<b class="caret"></b></a>
                <ul class="dropdown-menu" role="menu">
                  <li><a href="../api/utilities.html">Utilities</a></li>
                  <li><a href="../api/utilities.html#modules">Modules</a>
                    <ul>
                      <li><a href="../api/utilities.html#import">↪ import</a></li>
                      <li><a href="../api/utilities.html#class-name-superconstructor-constructor">↪ Class</a></li>
                    </ul>
                  </li>
                  <li><a href="../api/utilities.html#global-object">GLOBAL</a>
                    <ul>
                      <li><a href="../api/utilities.html#bind-thisarg-callback-args">↪ bind</a></li>
                      <li><a href="../api/utilities.html#merge-obj1-obj2-obj3">↪ merge</a></li>
                      <li><a href="../api/utilities.html#cache">↪ CACHE</a></li>
                    </ul>
                  </li>
                  <li><a href="../api/utilities.html#module-util.ajax">util.ajax</a></li>
                  <li class="divider"></li>
                  <li><a href="../api/math.html">Math</a></li>
                  <li><a href="../api/math.html#module-math.util">math.util</a></li>
                  <li><a href="../api/math.html#module-math.array">math.array</a></li>
                  <li><a href="../api/math.html#class-math.geom.point">math.geom.Point</a></li>
                  <li><a href="../api/math.html#class-math.geom.line">math.geom.Line</a></li>
                  <li><a href="../api/math.html#class-math.geom.circle">math.geom.Circle</a></li>
                  <li><a href="../api/math.html#class-math.geom.rect">math.geom.Rect</a></li>
                  <li><a href="../api/math.html#class-math.geom.vec2d">math.geom.Vec2D</a></li>
                  <li><a href="../api/math.html#module-math.geom.angle">math.geom.angle</a></li>
                  <li><a href="../api/math.html#module-math.geom.intersect">math.geom.intersect</a></li>
                </ul>
              </li>
              <!-- <li>
                <form class="navbar-search">
                  <input type="text" class="search-query" placeholder="Keyword">
                </form>
              </li> -->
            </ul>
          </div>
    </div><!--/navbar-->

    <div class="scrollable-content">
      <div class="container-fluid">
        <div class="row-fluid">
          <!--sidebar-->
          <div class="span2">
            <div id="toc-well" class="well sidebar-nav span2">
              <!--Sidebar content-->
              <nav id="toc"><ul>
<li><a href="#utilities">Utilities</a><ul>
<li><a href="#modules">Modules</a><ul>
<li><a href="#import">import</a></li>
<li><a href="#class-name-superconstructor-constructor">Class ([name, superConstructor,] constructor)</a></li>
</ul></li>
<li><a href="#global-object">GLOBAL <code>{object}</code></a><ul>
<li><a href="#bind-thisarg-callback-args">bind (thisArg, callback [, args …])</a></li>
<li><a href="#merge-obj1-obj2-obj3">merge (obj1, obj2 [, obj3 …])</a></li>
<li><a href="#cache">CACHE</a></li>
</ul></li>
</ul></li>
<li><a href="#module-util.ajax">Module: util.ajax</a><ul>
<li><a href="#examples">Examples</a></li>
<li><a href="#queuing">Queuing</a></li>
<li><a href="#error-handling">Error Handling</a></li>
<li><a href="#methods">Methods</a><ul>
<li><a href="#get-opts-callback">get (opts [, callback])</a></li>
<li><a href="#post-opts-callback">post (opts [, callback])</a></li>
</ul></li>
</ul></li>
</ul></nav>
            </div><!--/.well -->
          </div><!--/sidebar-->
          
          <div class="span10">
            <div id="main" class="row-fluid">
<h1 id="utilities">Utilities</h1>
<p>A variety of helper functions for working and managing JavaScript code.</p>
<h2 id="modules">Modules</h2>
<p>The Game Closure DevKit provides a framework to make development easier in JavaScript. This includes a class system to help structure your code and an import system so you can work in different source files.</p>
<h3 id="import">import</h3>
<p>The <code>import</code> statement is used to refer to external modules, as defined in a separate file, and include them in this file. Modules may be arranged in a namespace hierarchy to indicate a usage category. Additionally, modules may be aliased using the <code>as</code> keyword for easier reference.</p>
<p><em>Note: the <code>import</code> keyword is specific to the Game Closure DevKit and not standard JavaScript.</em></p>
<pre><code>import device;
import ui.View;
import src.path.to.Module as Module;

var view = new ui.View(),
    mod = new Module();

console.log(device.defaultFontFamily); //=&gt; &#39;Helvetica&#39;
console.log(typeof ui);                //=&gt; &#39;object&#39;</code></pre>
<p>The path of a user defined module is relative to the project’s root directory. So, in the above example, the import path of <code>Module</code> refers to the file located at <code>{project}/src/path/to/Module.js</code>.</p>
<p>Files may be imported realtive to the current source directory by prepending the path with a dot (<code>.</code>). To reference a file up a directory, use two dots.</p>
<pre><code>import .MyModule; //=&gt; ./MyModule.js (In this directory)
import ..foo;     //=&gt; ../foo.js     (In parent directory)
import ...foo;    //=&gt; ../../foo.js  (In grandparent directory)</code></pre>
<h3 id="class-name-superconstructor-constructor">Class ([name, superConstructor,] constructor)</h3>
<dl>
<dt>Parameters</dt>
<dd><ol type="1">
<li><code>name {string}</code> —An optional name to assign to the class for debugging purposes.</li>
<li><code>superConstructor {function}</code> —Optional superclass which this class inherits from.</li>
<li><code>constructor {function(supr)}</code> —The function that will define this class.</li>
</ol>
</dd>
<dt>Returns</dt>
<dd><ol type="1">
<li><code>{function}</code> —Class constructor.</li>
</ol>
</dd>
</dl>
<p>Our class system for simplifying JavaScript object inheritance. Objects of a class-type inherit the properties and methods defined on that class. A sub-class inherits the attributes of its super-class.</p>
<p>Properties and methods defined on the <code>this</code> object within the constructor function are considered public.</p>
<p>If an <code>init</code> method exists on the constructor definition, it is automatically called when an object is instantiated.</p>
<p>The constructor function is passed a <code>supr</code> argument—an accessor function which is used to call a given method name on the superclass. Typically, this is used to initialize all the objects in a class hierarchy.</p>
<pre><code>var MySuperClass = Class(function () {
  this.init = function (name) {
    this.name = name;
  };
});

var MyClass = Class(MySuperClass, function (supr) {
  this.init = function (name) {
    //Call the init of the super class with the arguments passed to this class.
    supr(this, &#39;init&#39;, arguments);  
  };

  this.say = function () {
    console.log(&quot;Hello, &quot; + this.name + &quot;!&quot;);
  };
});

var a = new MyClass(&#39;Arjun&#39;),
    b = new MyClass(&#39;Billy&#39;);

a.say(); //=&gt; &quot;Hello, Arjun!&quot;
b.say(); //=&gt; &quot;Hello, Billy!&quot;</code></pre>
<h2 id="global-object">GLOBAL <code>{object}</code></h2>
<p>The global object. Properties assigned to this object are available in the global scope, within any class or module. In a browser, this is the same as assigning a property to the <code>window</code> object.</p>
<p>For example, to create a property that is accessible throughout your modules and classes:</p>
<pre><code>GLOBAL.myprop = &quot;This is available throughout your code.&quot;</code></pre>
<h3 id="bind-thisarg-callback-args">bind (thisArg, callback [, args …])</h3>
<dl>
<dt>Parameters</dt>
<dd><ol type="1">
<li><code>thisArg {object}</code></li>
<li><code>callback {function}</code></li>
<li><code>args {...*}</code></li>
</ol>
</dd>
<dt>Returns</dt>
<dd><ol type="1">
<li><code>{function}</code></li>
</ol>
</dd>
</dl>
<p>Binds the first parameter as the <code>this</code> object in the callback function. Additional arguments are curried to the given function.</p>
<pre><code>function add_to_point (x, y) {
  return {
    x: this.x + x,
    y: this.y + y
  };
}
var pt = {x: 100, y: 400};
var add_to_y = bind(pt, add_to_point, 23);

add_to_y(56); //=&gt; {x: 123, y: 456}</code></pre>
<p>This convenience function is provided for readability over the traditional JavaScript <a href="https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Function/bind"><code>.bind</code></a> method:</p>
<pre><code>view.on(&#39;InputSelect&#39;, bind(this, function (evt) {
  //...
}));

view.on(&#39;InputSelect&#39;, (function (evt) {
  //..
}).bind(this));</code></pre>
<p>In the first example, it’s clear that a new context is assigned to <code>this</code> in the callback function at the beginning, where in the second example, the new binding of <code>this</code> doesn’t occur until the end of the function declaration.</p>
<h3 id="merge-obj1-obj2-obj3">merge (obj1, obj2 [, obj3 …])</h3>
<dl>
<dt>Parameters</dt>
<dd><ol type="1">
<li><code>base {object}</code></li>
<li><code>props {...object}</code></li>
</ol>
</dd>
<dt>Returns</dt>
<dd><ol type="1">
<li><code>{object}</code></li>
</ol>
</dd>
</dl>
<p>Combine the properties of multiple objects in to a single object. All properties are collected on the object passed as the first argument, and if a property already exists, subsequent values are ignored.</p>
<pre><code>var obj1 = {a: 1, b: 2},
    obj2 = {b: 3, c: 4};

merge(obj1, obj2); //=&gt; obj1

console.log(obj1); //=&gt; {a: 1, b: 2, c: 4}</code></pre>
<p>This function is particularly useful for combining objects that contain options that are passed up a class initialization hierarchy. However, there is a caveat for this common usage, since an options object may not exist, the properties can not be merged to an <code>undefined</code> value. To account for this, make sure to use the returned value of <code>merge</code>, as illustrated here:</p>
<pre><code>function not_merged (options) {
  merge(options, {x: 1});
  return options;
}

function merged (options) {
  options = merge(options, {x: 1});
  return options;
}

not_merged();  //=&gt; undefined
merged();      //=&gt; {x: 1}</code></pre>
<p>This way you can be assured that the options object contains all the properties you intend for it to have.</p>
<h3 id="cache">CACHE</h3>
<p>This is a cache of the JSON files in your project. Use it like this:</p>
<pre><code>var price = JSON.parse(CACHE[&#39;resources/conf/storeItems.json&#39;]).item3.price;</code></pre>
<h1 id="module-util.ajax">Module: util.ajax</h1>
<p>The Game Closure DevKit provides functions which make it easy to download data from remote locations. These functions can be found in the <code>ajax</code> package and wrap the <code>XMLHttpRequest</code> object.</p>
<h2 id="examples">Examples</h2>
<ul>
<li><a href="../example/ui-list-ajax/">Ajax populated list</a></li>
</ul>
<h2 id="queuing">Queuing</h2>
<p>When there are too many requests made within a short period of time, the requests are placed in a queue. The maximum number of requests which can be handled simultaneously is 4.</p>
<h2 id="error-handling">Error Handling</h2>
<p>The Ajax routines handle all errors and the first parameter of the callback is the error status. On success, the value is <code>null</code>, and on failure this parameter will give information about the error.</p>
<h2 id="methods">Methods</h2>
<h3 id="get-opts-callback">get (opts [, callback])</h3>
<dl>
<dt>Parameters</dt>
<dd><ol type="1">
<li><code>opts {object}</code> —Options
<ul>
<li><code>url {string}</code> —The URL.</li>
<li><code>type {string}</code> —Optional, can be unset or <code>json</code>.</li>
<li><code>data {object}</code> —Optional data to send.</li>
<li><code>headers {object}</code> —Optional list of http headers.</li>
</ul></li>
<li><code>callback {function}</code> —Optional callback which is executed when the data is downloaded.</li>
</ol>
</dd>
</dl>
<p>The following code fragement shows how to get data from the Facebook search API. The url parameter has the location of search API. The header is set to <code>text-plain</code> which is actually the default value.</p>
<p>The data option has two fields which are specific to this API, they are <code>q</code> which is the text to search for and <code>type</code> which is where to search (in posts). If the get function is invoked as demonstrated here then the values of <code>data</code> will be url encoded and appended to the url.</p>
<p>When the result is downloaded it will be parsed as JSON because the type was set to <code>json</code>.</p>
<pre><code>import util.ajax as ajax;

ajax.get({
  url: &#39;http://graph.facebook.com/search&#39;,
  headers: {&#39;Content-Type&#39;: &#39;text/plain&#39;},
  data: {q: &#39;game&#39;, type: &#39;post&#39;},
  type: &#39;json&#39;
}, function (err, response) {
  if (err) {
    console.error(&#39;someting went wrong&#39;);
  } else {
    console.log(response);
  }
});</code></pre>
<h3 id="post-opts-callback">post (opts [, callback])</h3>
<dl>
<dt>Parameters</dt>
<dd><ol type="1">
<li><code>opts {object}</code> —Options
<ul>
<li><code>url {string}</code> —The URL.</li>
<li><code>type {string}</code> —Optional, can be unset or <code>json</code>.</li>
<li><code>headers {object}</code> —Optional list of http headers.</li>
</ul></li>
<li><code>callback {function}</code> —Optional callback which is executed when the data is downloaded.</li>
</ol>
</dd>
</dl>
<p>The following demo posts data to the Facebook search API. Because the type value is not in the options the response will be a string.</p>
<p>The data will be posted and won’t be appended to the url as a query string.</p>
<pre><code>ajax.post({
  url: &#39;http://graph.facebook.com/search&#39;,
  data: {q: &#39;closure&#39;, type: &#39;post&#39;}
}, function (err, response) {
  if (err) {
    console.error(&#39;someting went wrong&#39;);
  } else {
    console.log(response);
  }
});</code></pre>
<p>Note that iOS devices commonly split POST requests into separate packets for the header and body. This is proper HTTP. Just make sure your server reads the request in using Content-Length instead of stopping at packet boundaries, which are arbitrary. For more information, see <a href="http://lists.apple.com/archives/macnetworkprog/2004/May/msg00042.html">this discussion of the BSD socket layer</a>.</p>
            </div><!--/row-->
          </div><!--/span-->
        </div><!--/row-->

        <footer>
          <p><a href="https://github.com/hashcube">Documentation</a> licensed under the <a href="../guide/license.html">Creative Commons</a></p>
        </footer>

      </div><!--/.fluid-container-->

      <div id="help-modal" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="help-modal-label" aria-hidden="true">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
          <h3 id="help-modal-label">Keyboard Shortcuts</h3>
        </div>
        <div class="modal-body">
          <table class="table table-striped">
            <thead>
              <tr>
                <th>Key</th>
                <th>Shortcut</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>?</td>
                <td>Display Help</td>
              </tr>
              <tr>
                <td>/</td>
                <td>Keyword Search</td>
              </tr>
              <tr>
                <td>E</td>
                <td>Go to Examples</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
    
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
    <script src="/include/bootstrap.min.js"></script>
    <script src="/include/prettify.js"></script>
    <script src="/include/init.js"></script>
    <script type="text/javascript" src="//assets.zendesk.com/external/zenbox/v2.5/zenbox.js"></script>
    <style type="text/css" media="screen, projection">
      @import url(//assets.zendesk.com/external/zenbox/v2.5/zenbox.css);
    </style>
    <script type="text/javascript">
      if (typeof(Zenbox) !== "undefined") {
        Zenbox.init({
          dropboxID:   "20148148",
          url:         "https://gcgameclosure.zendesk.com",
          tabID:       "Comments",
          tabColor:    "#1e4572",
          tabPosition: "Right"
        });
      }
    </script>
    <script>
      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-31868495-1']);
      _gaq.push(['_setDomainName', 'gameclosure.com']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
    </script>
  </body>
</html>
